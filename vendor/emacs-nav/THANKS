jawolter: patch for issue 91
vvavrychuk: patch for issue 92
rbanffy: patch for issue 94

